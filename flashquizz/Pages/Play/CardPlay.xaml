<ContentPage 
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="flashquizz.Pages.Play.CardPlay"
    xmlns:models="clr-namespace:flashquizz.Models"
    NavigationPage.HasNavigationBar="False">

    <Grid RowDefinitions="80,*">

        <!-- nav custom -->
        <Grid Grid.Row="0" HeightRequest="80">
            <BoxView Color="Black" />
            <Image Source="playnav.png" Aspect="AspectFit" HeightRequest="60" HorizontalOptions="End"/>

            <Label 
                TextColor="#FFD700"
                FontSize="24"
                FontAttributes="Bold"
                HorizontalOptions="Center"
                VerticalOptions="Center"/>

            <ImageButton
                Source="backarrow.png"
                HeightRequest="80"
                WidthRequest="80"
                Margin="15,0"
                HorizontalOptions="Start"
                VerticalOptions="Center"
                Clicked="OnBackClicked"/>
        </Grid>

        <!-- contenu -->
        <Grid Grid.Row="1">
            <BoxView Color="Black" />
            <Image Source="play.jpg" Aspect="AspectFill" Opacity="0.7"/>

            <BoxView HeightRequest="200" VerticalOptions="Start" InputTransparent="True">
                <BoxView.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#FF000000" Offset="0.0" />
                        <GradientStop Color="#00000000" Offset="1.0" />
                    </LinearGradientBrush>
                </BoxView.Background>
            </BoxView>

            <StackLayout Padding="10" Spacing="10">

                <!-- Titre -->
                <Label Text="{Binding Title}"
                       FontSize="20"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       TextColor="#FFD700"
                       FontFamily="OrbitronBold"
                       HorizontalTextAlignment="Center">
                    <Label.Shadow>
                        <Shadow Brush="#000000" Opacity="0.9" Offset="3,3" Radius="6"/>
                    </Label.Shadow>
                </Label>

                <!-- Progress bar fantasy -->
                <Grid HeightRequest="48"
                      WidthRequest="300"
                      HorizontalOptions="Center">                    
                    
                    <!-- Viewport = zone visible -->
                    <Grid x:Name="ProgressViewport"
                          Margin="52,0,0,0"
                          WidthRequest="250"
                          HeightRequest="23"
                          IsClippedToBounds="True"
                          HorizontalOptions="Start"
                          AnchorX="0">

                        <!-- Bande animée -->
                        <Grid x:Name="FillBand"
                              WidthRequest="750"
                              HeightRequest="23">

                            <Image Source="progress_fill.png"
                                   WidthRequest="250"
                                   HeightRequest="23"
                                   Aspect="AspectFit"/>

                            <Image Source="progress_fill.png"
                                   WidthRequest="250"
                                   HeightRequest="23"
                                   Aspect="AspectFit"
                                   TranslationX="250"/>

                            <Image Source="progress_fill.png"
                                   WidthRequest="250"
                                   HeightRequest="23"
                                   Aspect="AspectFit"
                                   TranslationX="500"/>
                        </Grid>
                    </Grid>

                    <!-- Cadre -->
                    <Image Source="progress_empty.png"
                           Aspect="Fill"/>
                </Grid>

                <!-- Carte -->
                <Border x:Name="CardContainer"
                        Stroke="Transparent"
                        StrokeThickness="0"
                        BackgroundColor="Transparent"
                        StrokeShape="RoundRectangle 25"
                        WidthRequest="300"
                        HeightRequest="450"
                        HorizontalOptions="Center"
                        VerticalOptions="Center">
                    <Border.Shadow>
                        <Shadow Brush="#000000" Opacity="0.5" Radius="25" Offset="0,10"/>
                    </Border.Shadow>                    

                    <Grid>
                        <Grid.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnCardTapped"/>
                        </Grid.GestureRecognizers>

                        <Image x:Name="CardImage"
                               Source="card1.jpg"
                               Aspect="AspectFill"/>

                        <Label x:Name="CardText"
                               Text=""
                               TextColor="#FFD700"
                               FontSize="22"
                               FontAttributes="Bold"
                               HorizontalTextAlignment="Center"
                               VerticalTextAlignment="Center"
                               Margin="45,0,45,0">
                            <Label.Shadow>
                                <Shadow Brush="Black"
                                        Offset="2,2"
                                        Radius="6"
                                        Opacity="0.9"/>
                            </Label.Shadow>
                        </Label>
                    </Grid>
                </Border>

                <Button Text="Réussi"
                        Clicked="OnSuccessClicked"
                        BackgroundColor="#2A2A2A"
                        TextColor="#FFD700"
                        FontSize="20"
                        HeightRequest="60"
                        WidthRequest="220"
                        CornerRadius="8"
                        BorderColor="#FFD700"
                        BorderWidth="2"
                        HorizontalOptions="Center"
                        Opacity="0.9"
                        Margin="0,0,0,0"/>

            </StackLayout>
        </Grid>
    </Grid>
</ContentPage>
